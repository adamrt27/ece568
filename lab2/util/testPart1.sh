#!/usr/bin/bash

# ECE568
# Lab 2: testPart1.sh

# The source materials you are provided in this lab are for your personal
# use only, as part of ECE568. Please do not post this file publicly
# (including on sites like GitHub, CourseHero, etc.).

# Please send any bug reports to Courtney Gibson <courtney.gibson@utoronto.ca>


cp ./util/values.json.sample values.json
chmod u+w values.json
cp ./util/publicKey.pem.sample publicKey.pem
chmod u+w publicKey.pem
cp ./util/privateKey.pem.sample privateKey.pem
chmod u+w privateKey.pem
chmod og-rwx merkleTree.py

echo -ne "\n- Checking a hash value... "

output=`./merkleTree.py 819539069f383c771e4fe42437e82539fcd7fde44217ea7a4c4fcb9eaf4b07b9`
test1=`echo "${output}" | cut -d" " -f4`

if [ "${test1}" == "'a9424f4004232abe6a074543035172da3460f1f4d2c47a110c0e5f9a74a610b6'," ]; then
	echo TEST PASSED
else
	echo TEST FAILED
fi

echo -n "- Checking a valid proof... "

test2=`./merkleTree.py 819539069f383c771e4fe42437e82539fcd7fde44217ea7a4c4fcb9eaf4b07b9 1c40791ee4fdcdde52b696c24c3be69ddcdde082aa870635099fdf905d780992 e8b23d4ba1b373dc1b1e2b9a724440ddd48e6f9ecae7a5ae108d1e98b5acf526 a9424f4004232abe6a074543035172da3460f1f4d2c47a110c0e5f9a74a610b6 8a3197bab016bfa9bed3a75d18064c73f78842c8afd58471af9bc6560a5a79440474152862214208a1778c7c4d17d661da905fd0551cc969d32c6010de48150f1b2ac0489b5607b55f8270f266b2ea1341fb9b1b80ac49c7925bceb67ad6a4d0a5cc770bb963612ce0d2a4743e9c9c26a24500012d096ddf9b94df487e98b844db6b27f34078ebcbc81b8527fd7a2fd9315f400248da45ac80b8bc0d480dc40283966052a3d4af69f2bf93664996b76da34f2e9a2d8467c94802e5bbf81e5998396505f0331cad78a7981e54f19e5c531c28df7f879050398ca8bc76f453c3a593595cda7f30dc39ff195809323b30b30b1abd1b6b07cbab7587ed6837f4d586dd01f0253bdce51b53572c3a1f55ec735386ba3bce1babe4e71750f1340cc8a19e9ddd894aede6887ba0510e67bbcc80d65ac15e668adb6327488e42f6c8a355c3f5ec3add1289f0a73a8bb178244903d73f7d53a5cb1ec88c8dabe3b5deffa2d893d0335415ccda6ada5651130e2111d58df25816f19dd00660097113648785c595be0ad6bf5269da6e2801de5462c9dd4441332459adab8972ab8ec396708716c721430ea5a5225ecd4a442e1c0247d01f465403b9a977076055be1cf28c7a40fc1966265be6b51cc964b5c281189ff7d48c982c0849dc64ff6e1ff319bf37eab334b8d62593abb33283d135006f4c69da0d0f667adcfbf74f98bcb766eecc`

if [ "${test2}" == "True" ] ; then
	echo TEST PASSED
else
	echo TEST FAILED
fi

echo -n "- Checking an invalid proof... "

test3=`./merkleTree.py 819539069f383c771e4fe42437e82539fcd7fde44217ea7a4c4fcb9eaf4b07b9 1c40791ee4fdc3de52b696c24c3be69ddcdde082aa870635099fdf905d780992 e8b23d4ba1b373dc1b1e2b9a724440ddd48e6f9ecae7a5ae108d1e98b5acf526 a9424f4004232abe6a074543035172da3460f1f4d2c47a110c0e5f9a74a610b6 8a3197bab016bfa9bed3a75d18064c73f78842c8afd58471af9bc6560a5a79440474152862214208a1778c7c4d17d661da905fd0551cc969d32c6010de48150f1b2ac0489b5607b55f8270f266b2ea1341fb9b1b80ac49c7925bceb67ad6a4d0a5cc770bb963612ce0d2a4743e9c9c26a24500012d096ddf9b94df487e98b844db6b27f34078ebcbc81b8527fd7a2fd9315f400248da45ac80b8bc0d480dc40283966052a3d4af69f2bf93664996b76da34f2e9a2d8467c94802e5bbf81e5998396505f0331cad78a7981e54f19e5c531c28df7f879050398ca8bc76f453c3a593595cda7f30dc39ff195809323b30b30b1abd1b6b07cbab7587ed6837f4d586dd01f0253bdce51b53572c3a1f55ec735386ba3bce1babe4e71750f1340cc8a19e9ddd894aede6887ba0510e67bbcc80d65ac15e668adb6327488e42f6c8a355c3f5ec3add1289f0a73a8bb178244903d73f7d53a5cb1ec88c8dabe3b5deffa2d893d0335415ccda6ada5651130e2111d58df25816f19dd00660097113648785c595be0ad6bf5269da6e2801de5462c9dd4441332459adab8972ab8ec396708716c721430ea5a5225ecd4a442e1c0247d01f465403b9a977076055be1cf28c7a40fc1966265be6b51cc964b5c281189ff7d48c982c0849dc64ff6e1ff319bf37eab334b8d62593abb33283d135006f4c69da0d0f667adcfbf74f98bcb766eecf`

if [ "${test3}" == "False" ] ; then
	echo -e "TEST PASSED\n"
else
	echo -e "TEST FAILED\n"
fi

